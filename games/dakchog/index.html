<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dak & Chog - The Dak and Chog Tavern</title>
  <link rel="stylesheet" href="../../css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script type="module" src="../../js/tavern.js"></script>
  <script type="module" src="../../js/state.js"></script>
  <style>
    body { background: url('../../assets/images/tavern-bg.png') no-repeat center center fixed; background-size: cover; }
    /* Overlapped logo like other games */
    .game-logo { display:block; height:auto; max-width: clamp(220px, 40vw, 560px); position:absolute; left:50%; top:0; z-index:3; transform: translate(-50%, -50%) scale(0.85); transform-origin: top center; filter: drop-shadow(0 6px 16px rgba(0,0,0,0.25)); pointer-events:none; user-select:none; }
    .tavern { padding-top: clamp(120px, 18vw, 200px); }
    @media (max-width: 600px) { .game-logo { transform: translate(-50%, -50%) scale(0.8); } .tavern { padding-top: clamp(110px, 24vw, 180px); } }

    .coin-wrap { display:flex; flex-direction:column; align-items:center; gap:12px; }
    .coin { width: clamp(160px, 28vw, 280px); height: clamp(160px, 28vw, 280px); background-position:center; background-repeat:no-repeat; background-size: contain; filter: drop-shadow(0 8px 18px rgba(0,0,0,0.25)); }
    .coin.flip { animation: flip 0.8s ease; }
    @keyframes flip { 0% { transform: rotateY(0deg); } 50% { transform: rotateY(180deg); } 100% { transform: rotateY(360deg); } }

    .choice { display:flex; align-items:center; justify-content:center; gap:8px; }
    .choice button { background: url('../../assets/images/nav-gem.png') no-repeat center / 100% 100%; border:none; color:#fff; font-weight:700; font-family:'Morris','Morris Alt',serif; text-shadow:0 1px 2px rgba(0,0,0,0.45); height:2.6em; padding:0 16px; cursor:pointer; }
    .choice button.active { box-shadow:0 0 0 2px #7800cd, 0 6px 18px rgba(120,0,205,0.35); transform: translateY(-1px) scale(1.03); }

    .cta { text-align:center; margin-top:8px; }
  </style>
</head>
<body class="game">
  <!-- Rules overlay (24h gating, versioned) -->
  <div id="rules-overlay" style="position:fixed; inset:0; background:rgba(0,0,0,0.6); display:none; align-items:center; justify-content:center; z-index:9999;">
    <div style="background:rgba(255,244,233,0.96); border:4px solid #7800cd; border-radius:12px; padding:16px; width:min(92vw, 820px); max-height:90vh; overflow:auto; text-align:left; color:#2b1e12;">
      <h2 style="margin-top:0;">Dak & Chog Rules</h2>
      <ul>
        <li>Select Dak or Chog as your side.</li>
        <li>Enter your wager and click Flip.</li>
        <li>The coin randomly lands on Dak or Chog.</li>
        <li>If your choice matches the result, you win 2x wager (bankroll permitting).</li>
        <li>Otherwise you lose your wager. Gas fees apply to each play.</li>
      </ul>
      <button id="rules-ack" style="margin-top:8px;">I have read and understand</button>
    </div>
  </div>

  <div class="top-banner" role="region" aria-label="Wallet and status">
    <div class="banner-left">
      <button id="return" class="return-btn">Return to Tavern</button>
      <div id="status" class="banner-status"></div>
    </div>
    <div class="banner-right">
      <div class="controls">
        <button id="connect-wallet">Connect Wallet</button>
      </div>
    </div>
  </div>

  <div class="tavern" style="position:relative; margin:clamp(180px, 14vw, 300px) auto 28px; width:95%; max-width:1000px;">
    <h1 class="visually-hidden">Dak &amp; Chog</h1>
    <img class="game-logo" src="../../assets/images/dakandchog-logo.png" alt="Dak &amp; Chog">
    <div style="text-align:center; margin-top:6px;"><button id="open-rules">Rules</button></div>

    <div class="coin-wrap">
      <div id="coin" class="coin" aria-live="polite"></div>
      <div class="choice" aria-label="Choose side">
        <button id="choose-dak" data-side="dak">Dak</button>
        <button id="choose-chog" data-side="chog">Chog</button>
      </div>
      <div class="controls" style="margin-top:6px;">
        <label>Bet (MON)</label>
        <input id="bet" type="number" min="0.001" step="0.001" value="0.01" style="width:110px; text-align:center;">
      </div>
      <div class="cta">
        <button id="flip">Flip</button>
      </div>
      <div id="dc-status" style="min-height:28px; text-align:center;"></div>
    </div>
  </div>

  <script type="module" src="dakchog.js"></script>
</body>
</html>
